@use '../styles/variables' as v;
@use '../styles/mixins' as m;

.navigation-controls {
  @include m.navigation-controls-container;
}

.nav-button {
  // Сначала все обычные свойства
  opacity: 1;
  pointer-events: auto;
  
  // Затем миксины
  @include m.nav-button;
  @include m.nav-button-keyboard;
  
  // Enhanced visual feedback
  &:active:not(:disabled) {
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
  }
  
  // Loading state (if needed)
  &.loading {
    opacity: 0.7;
    pointer-events: none;
  }
}

// Icon-specific nav buttons (for ⏮, ⏭, etc.)
.nav-button.icon-button {
  @include m.nav-icon-button;
}

.flip-button {
  // Сначала обычные свойства
  transition: all v.$transition-fast ease;
  
  // Затем миксины
  @include m.flip-button;
  @include m.nav-button-keyboard;
  
  // Убираем CSS-контент - будем использовать только JSX контент
  // &::before удален чтобы избежать дублирования
  
  &.flipped {
    // Можно добавить дополнительные стили для перевернутого состояния
    transform: scaleY(-1);
  }
}

.position-indicator {
  // Сначала обычные свойства
  font-family: v.$font-mono;
  letter-spacing: 0.5px;
  
  // Затем миксины
  @include m.position-indicator;
  
  // Responsive text
  @include m.tablet {
    font-size: 13px;
  }
  
  @include m.desktop {
    font-size: v.$position-indicator-size;
  }
}

// Button groupings for better organization
.nav-controls-group {
  @include m.nav-button-group;
  
  // Separator between groups
  &:not(:last-child)::after {
    content: '';
    width: 1px;
    height: 20px;
    background-color: v.$border-color;
    margin: 0 v.$spacing-xs;
    
    @include m.mobile {
      display: none;
    }
  }
}

// Special states
.nav-button {
  // First move button
  &.first-move {
    border-radius: v.$border-radius-sm 0 0 v.$border-radius-sm;
  }
  
  // Last move button  
  &.last-move {
    border-radius: 0 v.$border-radius-sm v.$border-radius-sm 0;
  }
  
  // Middle buttons in group
  &.middle-button {
    border-radius: 0;
    margin-left: -1px;
  }
}

// Accessibility improvements
@media (prefers-reduced-motion: reduce) {
  .nav-button,
  .flip-button {
    transition: none;
    
    &:hover:not(:disabled) {
      transform: none;
    }
  }
  
  .flip-button.flipped {
    transform: none;
  }
}

// High contrast mode
@media (prefers-contrast: high) {
  .navigation-controls {
    border: 2px solid v.$border-color;
  }
  
  .nav-button {
    border: 1px solid v.$nav-button-bg;
    
    &:disabled {
      border-color: v.$nav-button-disabled;
    }
  }
  
  .flip-button {
    border-width: 3px;
    
    &.flipped {
      border-width: 3px;
    }
  }
}

// Dark mode support (future-ready)
@media (prefers-color-scheme: dark) {
  .navigation-controls {
    background-color: #2a2a2a;
  }
  
  .position-indicator {
    color: #e0e0e0;
  }
}

// Touch device optimizations
@media (hover: none) and (pointer: coarse) {
  .nav-button,
  .flip-button {
    // Larger touch targets
    min-height: 44px;
    min-width: 44px;
    
    // Remove hover effects on touch devices
    &:hover {
      background-color: inherit;
      transform: none;
    }
    
    // Enhanced touch feedback
    &:active {
      background-color: v.$nav-button-hover;
      transform: scale(0.95);
    }
  }
  
  .flip-button {
    &:active {
      background-color: #e8e8e8;
    }
    
    &.flipped:active {
      background-color: v.$flip-button-flipped-hover;
      transform: scale(0.95) scaleY(-1);
    }
  }
}

// Print styles
@media print {
  .navigation-controls {
    display: none;
  }
}

// Focus management for keyboard navigation
.navigation-controls {
  // Skip link for screen readers
  &::before {
    content: '';
    position: absolute;
    left: -9999px;
    
    &:focus {
      position: static;
      content: 'Navigation controls';
      background: v.$info-background;
      color: v.$info-color;
      padding: v.$spacing-xs v.$spacing-sm;
      border-radius: v.$border-radius-sm;
      font-size: 12px;
      
      @include m.flex-center;
    }
  }
}

// Tooltip support (if tooltips are added later)
.nav-button,
.flip-button {
  position: relative;
  
  &[data-tooltip] {
    &::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: v.$text-color;
      color: v.$white;
      padding: v.$spacing-xs v.$spacing-sm;
      border-radius: v.$border-radius-sm;
      font-size: 11px;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity v.$transition-fast;
      z-index: v.$z-header;
    }
    
    &:hover::after {
      opacity: 1;
    }
  }
}